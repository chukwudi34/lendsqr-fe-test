@import "../../styles/variables.scss";

.table-filter {
  position: relative;
  display: inline-block;

  .filter-trigger {
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    transition: background-color 0.2s;

    &:hover {
      background-color: rgba(84, 95, 125, 0.1);
    }

    svg {
      opacity: 0.6;
    }
  }

  .filter-dropdown {
    position: absolute;
    top: 100%;
    right: 0;
    background: $white;
    border: 1px solid $border-color;
    border-radius: 4px;
    box-shadow: 0px 3px 5px rgba(0, 0, 0, 0.04);
    padding: 20px;
    width: 270px;
    z-index: 1001;
    margin-top: 8px;

    // Ensure dropdown doesn't get cut off on the right
    &.align-left {
      right: auto;
      left: 0;
    }

    // For columns that might be cut off, position relative to viewport
    &.viewport-positioned {
      position: fixed;
    }

    .filter-form {
      .filter-field {
        margin-bottom: 20px;

        &:last-child {
          margin-bottom: 0;
        }

        .filter-label {
          display: block;
          font-size: 14px;
          color: $text-light;
          margin-bottom: 6px;
          font-weight: 500;
        }

        .filter-input,
        .filter-select {
          width: 100%;
          padding: 12px 16px;
          border: 1px solid $border-color;
          border-radius: 8px;
          font-size: 14px;
          outline: none;
          transition: border-color 0.2s;
          background: $white;

          &:focus {
            border-color: $primary-blue;
          }

          &::placeholder {
            color: $text-muted;
          }
        }

        .filter-select {
          cursor: pointer;
          appearance: none;
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
          background-position: right 12px center;
          background-repeat: no-repeat;
          background-size: 16px;
          padding-right: 40px;
        }

        .filter-date {
          position: relative;
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3e%3cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z'/%3e%3c/svg%3e");
          background-position: right 12px center;
          background-repeat: no-repeat;
          background-size: 16px;
          padding-right: 40px;
        }
      }
    }

    .filter-actions {
      display: flex;
      gap: 14px;
      margin-top: 30px;

      .filter-btn {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid $border-color;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;

        &.filter-btn-reset {
          background: $white;
          color: $text-light;
          border-color: $border-color;

          &:hover {
            background: rgba(84, 95, 125, 0.05);
            border-color: rgba(84, 95, 125, 0.3);
          }
        }

        &.filter-btn-apply {
          background: $secondary-blue;
          color: $white;
          border-color: $secondary-blue;

          &:hover {
            background: darken($secondary-blue, 5%);
            border-color: darken($secondary-blue, 5%);
          }
        }
      }
    }
  }

  // Mobile responsiveness
  @media (max-width: 768px) {
    .filter-dropdown {
      width: 250px;
      padding: 16px;

      // Ensure dropdown stays within viewport
      &.align-left {
        left: -50px;
      }
    }
  }

  @media (max-width: 480px) {
    .filter-dropdown {
      width: 220px;
      padding: 12px;

      .filter-form {
        .form-group {
          margin-bottom: 12px;

          label {
            font-size: 12px;
            margin-bottom: 4px;
          }

          input,
          select {
            padding: 8px 10px;
            font-size: 12px;
          }
        }

        .filter-actions {
          gap: 8px;

          .filter-btn {
            padding: 8px 12px;
            font-size: 12px;
          }
        }
      }
    }
  }
}
